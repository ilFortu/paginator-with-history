/** @preserve
 *
 * Never ending scroll with history
 *
 Version: 0.0.4
 Author: Antonio Fortunato
 Website: https://github.com/ilFortu/paginator-with-history
 Docs: https://github.com/ilFortu/paginator-with-history
 Repo: https://github.com/ilFortu/paginator-with-history
 Issues: https://github.com/ilFortu/paginator-with-history/issues
 */
!function($){$.fn.paginatorHistory=function(options){function ajaxCall(page,isNext){page=parseInt(page),$.ajax({"url":setUrlwithPagination(ajaxUrl,page),"context":document.body}).done(function(content){settings.ajaxDoneBeforeItemsInPage.call(this);var html=content,removeLink=!1;if(null!=content&&""!=content)if(null!=settings.selectorContainer&&(html=$(content).find(settings.selectorContainer).html()),"undefined"!=typeof html&&""!=html){var newPageBlock="<div class='"+listItemsPage+"' data-page='"+page+"'>"+html+"</div>";isNext?($paginatorListContainer.append(newPageBlock),loadingNext=!1,$next.attr("data-page",page+1)):($paginatorListContainer.prepend(newPageBlock),window.scrollTo(0,$paginatorListContainer.find(listItemsPageClass+"[data-page='"+currentPage+"']").position().top),page>1?(loadingPrev=!1,$prev.attr("data-page",page-1)):removeLink=!0)}else removeLink=!0;else removeLink=!0;removeLink&&(isNext?$next.remove():$prev.remove()),settings.ajaxDoneAfterItemsInPage.call(this)})}function changeLocation(page,itemId){var newLocation=setUrlwithPagination(window.location.href,page);"undefined"!=typeof itemId&&null!=itemId&&(newLocation+="#"+itemId),history.replaceState(null,null,newLocation)}function setUrlwithPagination(url,page){if(url.indexOf(settings.paramPage+"=")<0)return url+(url.split("?")[1]?"&":"?")+settings.paramPage+"="+page;var regex=new RegExp("("+settings.paramPage+"=).*?((&)(.)*)?$");return url.replace(regex,"$1"+page+"$2")}var defaults={"paramPage":"page","selectorContainer":null,"ajaxDoneBeforeItemsInPage":function(){},"ajaxDoneAfterItemsInPage":function(){}},settings=$.extend({},defaults,options),$prev=this.find(".jph-prev"),$next=this.find(".jph-next");if($prev.length>0||$next.length>0){var $paginatorListContainer=this.find(".jph-list-container"),ajaxUrl=this.data("jph-ajax-url"),listItemsPage="jph-list-items-page",listItemsPageClass="."+listItemsPage,item=".jph-item",linkItem=".jph-item-link",currentPage=this.find(listItemsPageClass).data("page"),loadingNext=!1,loadingPrev=!1;$prev.length>0&&$prev.attr("data-page")>0&&(loadingPrev=!0,ajaxCall($prev.attr("data-page"),!1)),this.on("click",linkItem,function(evt){changeLocation($(this).parents(listItemsPageClass).attr("data-page"),$(this).parents(item).attr("id"))}),$(window).scroll(function(){console.log("scrolling");var scrollPos=$(window).scrollTop();$next.length>0&&!loadingNext&&$next.position().top-200<scrollPos+$(window).height()&&(loadingNext=!0,console.log("NEXT"),ajaxCall($next.attr("data-page"),!0)),$prev.length>0&&!loadingPrev&&scrollPos-$prev.position().top<200&&(loadingPrev=!0,console.log("PREV"),ajaxCall($prev.attr("data-page"),!1));var scrollHalfPosition=$(window).scrollTop()+$(window).height()/2;$(listItemsPageClass).each(function(){var top=$(this).position().top,bottom=$(this).position().top+$(this).height();$(this).attr("data-page")!=currentPage&&scrollHalfPosition>=top&&bottom>=scrollHalfPosition&&(currentPage=$(this).attr("data-page"),changeLocation(currentPage,null))})}),$(window).trigger("scroll")}}}(jQuery);
//# sourceMappingURL=jquery.paginator.history.min.js.map