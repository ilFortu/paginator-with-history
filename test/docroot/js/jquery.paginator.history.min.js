/** @preserve
 *
 * Never ending scroll with history
 *
 Version: 0.0.6
 Author: Antonio Fortunato
 Website: https://github.com/ilFortu/paginator-with-history
 Docs: https://github.com/ilFortu/paginator-with-history
 Repo: https://github.com/ilFortu/paginator-with-history
 Issues: https://github.com/ilFortu/paginator-with-history/issues
 */
!function($){$.fn.paginatorHistory=function(options){function mouseWheel(){var e=window.event||e,delta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));switch(delta){case 1:moveWindow("up");break;case-1:moveWindow("down")}}function moveWindow(direction){var scrollPos=$(window).scrollTop();"down"==direction&&null!=$next&&!loadingPage&&$next.position().top-settings.offsetCallPage<scrollPos+$(window).height()?(loadingPage=!0,console.log("NEXT"),ajaxCall($next.attr("data-page"),!0)):"up"==direction&&null!=$prev&&!loadingPage&&scrollPos-$prev.position().top<settings.offsetCallPage&&(loadingPage=!0,ajaxCall($prev.attr("data-page"),!1));var scrollHalfPosition=$(window).scrollTop()+$(window).height()/2;$(listItemsPageClass).each(function(){var top=$(this).position().top,bottom=$(this).position().top+$(this).height();$(this).attr("data-page")!=currentPage&&scrollHalfPosition>=top&&bottom>=scrollHalfPosition&&(currentPage=$(this).attr("data-page"),changeLocation(currentPage,null))})}function ajaxCall(page,isNext,prevLoadOnStart){page=parseInt(page),$.ajax({"url":setUrlwithPagination(ajaxUrl,page),"context":document.body}).done(function(content){settings.ajaxDoneBeforeItemsInPage.call(this);var html=content,removeLink=!1;if(null!=content&&""!=content)if(null!=settings.selectorContainer&&(html=$(content).find(settings.selectorContainer).html()),"undefined"!=typeof html&&""!=html){var newPageBlock="<"+settings.blockPageHtmlElement+" class='"+listItemsPage+"' data-page='"+page+"'>"+html+"</"+settings.blockPageHtmlElement+">";if(isNext)$paginatorListContainer.append(newPageBlock),page++,$next.attr("data-page",page);else{$paginatorListContainer.prepend(newPageBlock);var scrollTo=0;if(prevLoadOnStart){var $currentBlock=$paginatorListContainer.find(listItemsPageClass+"[data-page='"+currentPage+"']"),hash=window.location.hash.substring(1);""!=hash&&$currentBlock.find("#"+hash).length>0&&($currentBlock=$currentBlock.find("#"+hash)),scrollTo=$currentBlock.position().top}else if(0!=window.pageYOffset){var heightPrevPage=$paginatorListContainer.find(listItemsPageClass+"[data-page='"+page+"']").height();scrollTo=window.pageYOffset+heightPrevPage}window.scrollTo(0,scrollTo),page>1?(page--,$prev.attr("data-page",page)):removeLink=!0}}else removeLink=!0;else removeLink=!0;removeLink&&(isNext?($next.remove(),$next=null):($prev.remove(),$prev=null)),loadingPage=!1,settings.ajaxDoneAfterItemsInPage.call(this)})}function changeLocation(page,itemId){var newLocation=setUrlwithPagination(window.location.href,page);"undefined"!=typeof itemId&&null!=itemId&&(newLocation+="#"+itemId),history.replaceState(null,null,newLocation)}function setUrlwithPagination(url,page){if(url.indexOf(settings.paramPage+"=")<0)return url+(url.split("?")[1]?"&":"?")+settings.paramPage+"="+page;var regex=new RegExp("("+settings.paramPage+"=).*?((&)(.)*)?$");return url.replace(regex,"$1"+page+"$2")}var defaults={"paramPage":"page","offsetCallPage":500,"selectorContainer":null,"blockPageHtmlElement":"div","ajaxDoneBeforeItemsInPage":function(){},"ajaxDoneAfterItemsInPage":function(){}},settings=$.extend({},defaults,options),$prev=this.find(".jph-prev").length>0?this.find(".jph-prev"):null,$next=this.find(".jph-next").length>0?this.find(".jph-next"):null;if(null!=$prev||null!=$next){var $paginatorListContainer=this.find(".jph-list-container"),ajaxUrl=this.data("jph-ajax-url"),listItemsPage="jph-list-items-page",listItemsPageClass="."+listItemsPage,item=".jph-item",currentPage=this.find(listItemsPageClass).data("page"),loadingPage=!1;null!=$prev&&$prev.attr("data-page")>0&&(loadingPage=!0,ajaxCall($prev.attr("data-page"),!1,!0));var linkItem=".jph-item-link";this.on("click",linkItem,function(evt){changeLocation($(this).parents(listItemsPageClass).attr("data-page"),$(this).parents(item).attr("id"))}),function(){var previousScroll=0;$(window).scroll(function(){var currentScroll=$(this).scrollTop();moveWindow(currentScroll>previousScroll?"down":"up"),previousScroll=currentScroll})}(),window.addEventListener("mousewheel",mouseWheel,!1),window.addEventListener("DOMMouseScroll",mouseWheel,!1);var swipeFunc={"touches":{"touchstart":{"y":-1},"touchmove":{"y":-1},"touchend":!1,"direction":"undetermined"},"touchHandler":function(event){var touch;if("undefined"!=typeof event&&"undefined"!=typeof event.touches)switch(touch=event.touches[0],event.type){case"touchstart":case"touchmove":swipeFunc.touches[event.type].y=touch.pageY;break;case"touchend":swipeFunc.touches[event.type]=!0,swipeFunc.touches.touchstart.y>-1&&swipeFunc.touches.touchmove.y>-1&&(swipeFunc.touches.direction=swipeFunc.touches.touchstart.y<swipeFunc.touches.touchmove.y?"up":"down",moveWindow(swipeFunc.touches.direction))}},"init":function(){document.addEventListener("touchstart",swipeFunc.touchHandler,!1),document.addEventListener("touchmove",swipeFunc.touchHandler,!1),document.addEventListener("touchend",swipeFunc.touchHandler,!1)}};swipeFunc.init()}}}(jQuery);
//# sourceMappingURL=jquery.paginator.history.min.js.map